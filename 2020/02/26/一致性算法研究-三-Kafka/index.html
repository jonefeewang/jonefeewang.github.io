<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="王军飞的博客"><title>一致性算法研究(三)Kafka | 王军飞的随笔</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 7.1.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">一致性算法研究(三)Kafka</h1><a id="logo" href="/.">王军飞的随笔</a><p class="description">always be the best</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">一致性算法研究(三)Kafka</h1><div class="post-meta">2020-02-26<span> | </span><span class="category"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%80%E6%9C%AF/">分布式技术</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.2k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 7</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" href="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/#vcomment"><span class="valine-comment-count" data-xid="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/"></span><span> 条评论</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">1.</span> <span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E8%AF%8D"><span class="toc-number">2.</span> <span class="toc-text">关键词</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">3.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kafka%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="toc-number">4.</span> <span class="toc-text">Kafka基本知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E9%97%AE%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">共识问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%86%E8%8A%82"><span class="toc-number">6.</span> <span class="toc-text">细节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">7.</span> <span class="toc-text">参考:</span></a></li></ol></div></div><div class="post-content"><p><span class="github-emoji" style="display:inline;vertical-align:middle"><span>⚠</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 原创文章，转载请注明出处</p>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a><a href="#%E6%91%98%E8%A6%81" title="摘要"></a>摘要</h2><p>一致性算法是分布式系统中的一个重要协议，是分布式数据库、Kafka、Zookeeper的基本协议。但这些协议晦涩难懂，对初学者需要耗费大量时间研究，本系列文章，是对一致性算法的一个大搜底和总览，通过对paper和技术资料的阅读，总结出一个简单易懂的学习材料，供其他人方便理解和学习。</p>
<h2 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a><a href="#%E5%85%B3%E9%94%AE%E8%AF%8D" title="关键词"></a>关键词</h2><p>consensus algorithm(一致性算法) 分布式系统 一致性算法 Paxos Raft ZooKeeper ZAB</p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a><a href="#%E8%83%8C%E6%99%AF" title="背景"></a>背景</h2><p>在谈到分布式系统时，很难不提及的产品除了ZooKeeper之外，另外一个就是Kafka. Apache Kafka是一个典型的分布式系统，整个系统从外围看，非常像我们说明共识问题时的例子 :</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/replication.svg" title="distrabute replication"></p>
<p>S1-S5是Kafka整个集群，client 1 是生产端，client 2是消费端。整个集群支持消息的写入和读取，并且能保持不丢消息，不乱序。本节内容，我们一起来看下Kafka是怎么解决分布式场景下的共识问题的。</p>
<h2 id="Kafka基本知识"><a href="#Kafka基本知识" class="headerlink" title="Kafka基本知识"></a><a href="#Kafka%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86" title="Kafka基本知识"></a>Kafka基本知识</h2><p>一个Kafka集群有若干台机器组成，一个集群可以运营成百上千个队列，一个队列可以有几个分区，比如下图所示，有3台机器(BrokerA、BrokerB、BrokerC)组成的一个集群，有两个topic： TopicA 和 TopicB。</p>
<p>TopicA有3个分区，分别标为重蓝色，重黄色，重粉色。3个分区平均分布在3台机器上，一台机器上一个。分区存储着队列的消息信息，在这个例子里，topicA有3个分区，消息也分3部分，分别存储在这3个分区上，但是Kafka集群为了规避单点风险，每个分区又会有一个或多个副本，副本数量可以自己定义，一般是1-3 个副本，1个副本的话是有单点风险的，2个副本容忍1个集群有1台机器宕机的情况下，队列仍然高可用，不影响消息的收发，3副本容忍2台机器同时宕机。所以，有f+1个副本的kafka topic容忍f个副本的机器同时宕机。</p>
<p>下图示例，topicA有3个分区，每个分区有3个副本，3个副本会平均分布在3台服务器上，比如topicA分区1主副本在BrokerA上，从副本rep1和rep2分别在BrokerB和BrokerC上，从副本会不断同步主副本的数据，和主副本保持一致，当主副本所在的机器宕机后，两个从副本所在的机器会在剩余的两个副本之间选出一个副本作为主副本，继续消息的收发，保持系统高可用。topicB有2个分区，只有一个副本。</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/kafka.svg" title="kafka"></p>
<p>客户端有两个clientA 和 clientB。Kafka集群在接收客户端发送消息或读取消息的请求时，只会将请求发送给每个分区的主分区所在的服务器来处理。比如发送消息时，客户端将消息内容发送给topicA分区1的主分区所在的服务器BrokerA，由于分区1的副本rep1/rep2(replica 1和replica 2 下同)分别在BrokerB和BrokerC上，BrokerB和BrokerC上分别驻留一个消息复制器，负责把BrokerA上topicA主分区的消息拉给自身所在的从副本rep1和rep2上。</p>
<p>消息复制器在每台broker上都有一个，分别启动线程去其他服务器拉自己感兴趣的分区主本消息。</p>
<h2 id="共识问题"><a href="#共识问题" class="headerlink" title="共识问题"></a><a href="#%E5%85%B1%E8%AF%86%E9%97%AE%E9%A2%98" title="共识问题"></a>共识问题</h2><p>上边讲到topicA有3个分区，每个分区有3个副本，这样的队列容忍集群内同时有2台服务器宕机的情况下保持高可用。每个分区的3个副本平均分布在3台服务器上，那么问题来了，这3个副本怎么保持一致呢？</p>
<p>如下图所示，生产端在发送一条消息”id=101”后，消息发送到了分区的“主本“机器BrokerA上，消息的两个副本分别在Broker B和Broker C上，由上边所讲，Broker B和Broker C依赖本机的“消息复制器”将消息复制到本机副本中。如果”Client生产端“配置发送策略为”Ack=-1”，那么这条消息只有在Broker B和Broker C两台机器复制完成后，才算发送成功。这就保证了“消息如果发送成功”，那么其他副本一定是接收到消息了。</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/msg_replicate.svg" title="kafka message replication"></p>
<p>但是，中间过程中的机器宕机等情况时，怎么来保证一致性呢？ 这个问题，kafka交给了zookeeper来解决。kafka集群启动时，会依靠zookeeper来选举一个集群的主节点服务器(controller)，controller来管理整个集群，比如队列的创建、删除，队列分区的选主，如前边所说的，topicA有3个分区，每个分区有3个副本(replica)，在创建每个分区时，kafka会使用zookeeper来选举一个分区副本的主(leader)。</p>
<p>一个集群内有上千个队列，每个队列都有数十个甚至数百个分区，每个分区又会有若干个副本，多个副本之间谁是leader副本？这些信息称之为metadata，kafka全部储存在了zookeeper上。</p>
<p>所以机器宕机时，controller和leader replica的选举任务都交给了zookeeper来完成，那么这时集群内机器之间的一致性，分区副本之间的一致性，这些共识问题都交给了zookeeper来解决。有了zookeeper，集群内每个机器不会对谁是controller再产生分歧，有了controller，一个集群就一个统一的“负责人”。同时，每个分区的副本之间使用zookeeper来选主，也会产生一个“负责人”，所有机器，多个副本之间都交由这些负责人来协调，不会再产生分歧，而且不会脑裂。</p>
<h2 id="细节"><a href="#细节" class="headerlink" title="细节"></a><a href="#%E7%BB%86%E8%8A%82" title="细节"></a>细节</h2><p>如下图所示，假设brokerA是当前集群的controller，当brokerA宕机后，其他broker马上会通过zookeeper来感知到，在brokerB/brokerC来选取一个新的controller出来。这个过程是通过抢占zookeeper的临时节点来实现的，因此共识问题、一致性问题都由zookeeper来保障。</p>
<p>同样切换的还有分区的leader，比如topicA分区1的leader原来在brokerA上，当brokerA宕机后，topicA分区1会在rep1和rep2之间选取一个新的分区leader，如下图所示，原来的分区1的rep1变成了新的分区leader，可以继续接受客户端的读写请求了。</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/brokerA_down.svg" title="brokerA down"></p>
<p>在选取新的分区副本leader 时，kafka会优先选取消息数量和主本一样的副本，怎么实现的呢？</p>
<p>正常运行时，有3个副本的分区，kafka维持一个ISR(In sync replica)的概念，如果3个副本的消息量在一定时间内是一样的，那这三个副本就都在ISR内。如果某个副本的消息，在指定的时间内，没有同主本消息保持一致，这个副本就会被踢出ISR。如果3个副本里，主本一直接收消息，2个副本都在一定的时间内，没能跟上主本的消息数量，这时ISR缩减为主本一个，这时主本如果宕机会有丢消息的风险。因此，kafka有一个专门的设置，min ISR(in sync replica)数量，如果数量低于一定的值，kafka 集群就不再接收消息，因为这时集群是有丢消息的风险。这也是可用性(A)和一致性(C)之间的一个选择。</p>
<p>ISR的信息同样存储在zookeeper中，由zookeeper来保障信息的一致性。在客户端发送一条消息后，需要ISR里的各replica都确认收到消息后才能算成功，如下图所示:</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/kafka_commit.svg" title="kafka commit msg"></p>
<p>与下图zookeeper的消息接收不一样，zookeeper只需要多数(quorum)确认收到即可：</p>
<p><img src="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/zk_commit.svg" title="zookeeper commit msg"></p>
<p>Kafka这中可以配置的确认机制，相比zookeeper会比较灵活一些，比如有9个机器组成的集群，zookeeper需要5个机器确认收到消息，而kafka只需要配置2或3即可保证消息不丢失，减少leader副本因等待接收ack而消耗的时间。</p>
<p>但在集群quorum比较小的情况，zookeeper的确认机制是比较占优势的。比如，当zookeeper的quorum是3的时候，如上图的情况，leader节点只需要收到任意一个follower的ack即可算发送成功，但是kafka需要等待两个副本都收到消息后，才能算发送成功。在这种场景下，zookeeper的确认机制是占优势的。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考:"></a><a href="#%E5%8F%82%E8%80%83" title="参考:"></a>参考:</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.confluent.io/blog/distributed-consensus-reloaded-apache-zookeeper-and-replication-in-kafka/">https://www.confluent.io/blog/distributed-consensus-reloaded-apache-zookeeper-and-replication-in-kafka/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.semanticscholar.org/paper/Zab%3A-High-performance-broadcast-for-primary-backup-Junqueira-Reed/b02c6b00bd5dbdbd951fddb00b906c82fa80f0b3">https://www.semanticscholar.org/paper/Zab%3A-High-performance-broadcast-for-primary-backup-Junqueira-Reed/b02c6b00bd5dbdbd951fddb00b906c82fa80f0b3</a></li>
</ol>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css?v=1.0.0"><p><span>本文标题：</span>一致性算法研究(三)Kafka</p><p><span>文章作者：</span>王军飞 jonefeewang@outlook.com</p><p><span>发布时间：</span>2020-02-26</p><p><span>最后更新：</span>2024-03-24</p><p><span>原始链接：</span><a href="/2020/02/26/一致性算法研究-三-Kafka/">https://www.wangjunfei.com/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://www.wangjunfei.com/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/"></i></span></p><p><span>版权声明：</span>原创文章转载请注明出处</p></div><br><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://www.wangjunfei.com/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%B8%89-Kafka/" data-id="clu4tf7cp001ijts6g15kbtma" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAAD5klEQVR42u3bS27jQAwFQN//0gqQbWDrPbLlwQClVRArre7SguYnr1d8Xb9X8ukVX7P7/z7388qvJy4cOHDgwBEcdbb0u3vyA/+95/Nqn9dPfnMDjQMHDhw4DnHk4TM/cB4UTz03+aubs+PAgQMHji9ybNK5fP38iWdXwIEDBw4c3+fIw167raRS166AAwcOHDj+LUfbHMoLc3l/Z/PpprmFAwcOHDjOcmyC1v/y84PzHThw4MCBYxSu2sRskxbO7r/WFw4cOHDg2HPsD5MX9U59F2iTtLrIiAMHDhw4DnEUjZl49K0t0rXBe19exIEDBw4cz3Fsglwy3JAH5k2QbgMwDhw4cOA4y5EPuuVDDO14waz7MxutuwnqOHDgwIHjEMdsOGDWoEpWS46xTwLfNpxw4MCBA8eCYxaoZoG5DntlctgWK3HgwIEDx3Mc+RbPtpHaMYV2TLz9ooADBw4cOPYcbQjMg9YsDM+G8PKBjJt7cODAgQPHAxx5CtTG87z8l4/xtXfe0ODAgQMHjgc4NsNnedrWlghn6Vm+Bxw4cODAcYqj3XR7sHbQYVY6TE5UBHIcOHDgwLHmmB0yD8+zIYO2RNgOw+XJIQ4cOHDg2HPkWElILib11snbqRPhwIEDB47ZidqRhbPJ0mZgejUb+G7/OHDgwIFjzdGmQ5vona+/GYabhX8cOHDgwHGW47lmTx6S9+XIfFRi9rJx4MCBA8eMoy23JcFyVsK7yuvUkAQOHDhw4NhwtA/LU6Mnhg82LyAqTeLAgQMHjjVHe6S2ITRLvdr0LH9u9Mpx4MCBA8eCYxYCz3Js2lH5O09+xoEDBw4ce462kDcbWctXmw035GlbtEMcOHDgwLHgaAttn4NlXl7MC4L5sdtU8G2IxYEDBw4chzjytKptCLV87V+1QfotDQ4cOHDgWHMkNw0XHSVpswSyHa2rwy0OHDhw4FhwbMYCNsXHFugU9E2gxYEDBw4c5TptEJ0V/tpyXk68aVbVkRwHDhw4cJQc7WjCpmk0a1/lKHlK+XZyEAcOHDhwLDja1KttQc2aVTPQ2Yu86cLhwIEDB44yU0sSrc34Wr7RNp9qy5QRKw4cOHDgWHBc5XVqJG4TOPdJ4833Dhw4cODAseDIrzbRyttL+YZmpcZ2zzhw4MCBY8/RBtdNMtYWH9uUbDOihwMHDhw4znLkgW0/oPAqr82IQ50Q4sCBAweOL3K0gW02ypaX9tp2VMSKAwcOHDi+zpEHwtnK+/2shv9w4MCBA8chjv1oWhtoTx1mli5Gk4M4cODAgeMa/6dnMdDw+Tdtea4IgZtmUlz0xIEDBw4cC44fXl9oOgelBxEAAAAASUVORK5CYII=">分享</a><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/consensus-algorithm/" rel="tag">consensus algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/" rel="tag">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zab/" rel="tag">zab</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95/" rel="tag">一致性算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%80%E6%9C%AF/" rel="tag">分布式技术</a></li></ul></div><div class="post-nav"><a class="pre" href="/2020/03/15/%E7%A3%81%E7%9B%98%E8%AF%BB%E5%86%99%E4%BC%98%E5%8C%96%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6-Zookeeper-Kafka-MySQL/">磁盘读写优化技术研究-Zookeeper/Kafka/MySQL</a><a class="next" href="/2020/02/26/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95%E7%A0%94%E7%A9%B6-%E4%BA%8C-ZooKeeper-ZAB%E5%8D%8F%E8%AE%AE/">一致性算法研究(二)ZooKeeper ZAB协议</a></div><div class="nofancybox" id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == 'true' ? true : false;
var verify = 'true' == 'true' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'FNjCNRwQqC3sTPP04DfRFIk9-gzGzoHsz',
  appKey:'LzCq5t6a6RTkwXQVr8xLk0yj',
  serverURLs:'',
  placeholder:'请理性评论',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10'
})
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="https://www.wangjunfei.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>Always be the best</p><a class="info-icon" href="mailto:jonefeewang@outlook.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/jonefeewang" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%80%E6%9C%AF/">分布式技术</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8A%A1%E8%99%9A-%E4%BA%A4%E6%B5%81%E6%B2%9F%E9%80%9A/">务虚-交流沟通</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8A%A1%E8%99%9A-%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95%E8%AE%BA/">务虚-管理方法论</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A3%81%E7%9B%98%E8%AF%BB%E5%86%99%E4%BC%98%E5%8C%96/">磁盘读写优化</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Apache-Pulsar/" style="font-size: 15px;">Apache Pulsar</a> <a href="/tags/Apache-Bookkeeper/" style="font-size: 15px;">Apache Bookkeeper</a> <a href="/tags/Apache-Kafka/" style="font-size: 15px;">Apache Kafka</a> <a href="/tags/Apache-pulsar-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97-kafka-RocketMQ/" style="font-size: 15px;">Apache pulsar 消息队列 kafka RocketMQ</a> <a href="/tags/kafka-raft-kraft-zookeeper/" style="font-size: 15px;">kafka raft kraft zookeeper</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 15px;">消息队列</a> <a href="/tags/rocketmq/" style="font-size: 15px;">rocketmq</a> <a href="/tags/kafka/" style="font-size: 15px;">kafka</a> <a href="/tags/pulsar/" style="font-size: 15px;">pulsar</a> <a href="/tags/%E5%8A%A1%E8%99%9A-%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95%E8%AE%BA/" style="font-size: 15px;">务虚-管理方法论</a> <a href="/tags/%E5%8D%8E%E4%B8%BA/" style="font-size: 15px;">华为</a> <a href="/tags/%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95%E8%AE%BA/" style="font-size: 15px;">管理方法论</a> <a href="/tags/%E7%AE%A1%E7%90%86/" style="font-size: 15px;">管理</a> <a href="/tags/%E5%8A%A1%E8%99%9A-%E9%A2%86%E5%AF%BC%E6%A2%AF%E9%98%9F/" style="font-size: 15px;">务虚-领导梯队</a> <a href="/tags/%E5%8A%A1%E8%99%9A/" style="font-size: 15px;">务虚</a> <a href="/tags/%E5%8D%8F%E4%BD%9C/" style="font-size: 15px;">协作</a> <a href="/tags/%E8%BD%AF%E7%B4%A0%E8%B4%A8/" style="font-size: 15px;">软素质</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%80%E6%9C%AF/" style="font-size: 15px;">分布式技术</a> <a href="/tags/zookeeper/" style="font-size: 15px;">zookeeper</a> <a href="/tags/consensus-algorithm/" style="font-size: 15px;">consensus algorithm</a> <a href="/tags/zab/" style="font-size: 15px;">zab</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%8F%E8%AE%AE/" style="font-size: 15px;">分布式协议</a> <a href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7%E7%AE%97%E6%B3%95/" style="font-size: 15px;">一致性算法</a> <a href="/tags/%E6%96%B9%E6%B3%95%E8%AE%BA-%E8%BD%AF%E7%B4%A0%E8%B4%A8%E6%8F%90%E5%8D%87/" style="font-size: 15px;">方法论 软素质提升</a> <a href="/tags/kafka-netty-%E6%97%B6%E9%97%B4%E8%BD%AE/" style="font-size: 15px;">kafka netty 时间轮</a> <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 15px;">云原生</a> <a href="/tags/%E6%B5%81%E5%BC%8F%E8%AE%A1%E7%AE%97/" style="font-size: 15px;">流式计算</a> <a href="/tags/%E7%A3%81%E7%9B%98%E8%AF%BB%E5%86%99%E4%BC%98%E5%8C%96/" style="font-size: 15px;">磁盘读写优化</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/12/25/Apache-Pulsar%E7%9A%84%E5%AD%98%E5%82%A8%E6%A8%A1%E5%9E%8B/">Apache Pulsar的存储模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/09/15/Apache-pulsar%E5%AF%B9zookeeper%E7%9A%84%E4%BE%9D%E8%B5%96%E5%92%8C%E5%8E%BB%E9%99%A4%E5%88%86%E6%9E%90-%E4%BA%8C/">Apache pulsar对zookeeper的依赖和去除分析(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/06/15/Apache-pulsar%E5%AF%B9zookeeper%E7%9A%84%E4%BE%9D%E8%B5%96%E5%92%8C%E5%8E%BB%E9%99%A4%E5%88%86%E6%9E%90-%E4%B8%80/">Apache pulsar对zookeeper的依赖和去除分析(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/10/%E6%97%B6%E9%97%B4%E8%BD%AE%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E5%92%8C%E5%BA%94%E7%94%A8/">时间轮算法分析和应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/01/Kafka%E5%8E%BBZookeeper%E6%8F%AD%E7%A7%98/">Kafka去Zookeeper揭秘</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/15/PRFAQ%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/">「转」PRFAQ编写规范</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/13/%E5%87%A0%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%96%B9%E6%B3%95%E8%AE%BA%E6%B1%87%E9%9B%86/">「转」几种常见的工作方法论汇集</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/14/%E8%BD%AF%E7%B4%A0%E8%B4%A8%E8%9E%BA%E6%97%8B%E4%B8%8A%E5%8D%87/">软素质螺旋上升</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/22/Mafka%E5%85%A8%E9%93%BE%E8%B7%AF%E5%BC%B9%E6%80%A7%E4%BC%B8%E7%BC%A9%E6%BC%94%E8%BF%9B%E7%AD%96%E7%95%A5/">Mafka全链路弹性伸缩演进策略</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/14/Mafka-LRP/">Mafka长期发展规划(LRP)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">王军飞的随笔.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>